!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@angular/router")):"function"==typeof define&&define.amd?define("angulartics2",["exports","@angular/core","rxjs","rxjs/operators","@angular/common","@angular/router"],e):e(t.angulartics2={},t.ng.core,t.rxjs,t.rxjs.operators,t.ng.common,t.ng.router)}(this,function(t,e,a,n,r,i){"use strict";var s=function(){return t=Object.assign||function t(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var a in e=arguments[r])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},t.apply(this,arguments)};function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,a,i=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)s.push(n.value)}catch(o){a={error:o}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(a)throw a.error}}return s}var c=function u(){this.pageTracking={autoTrackVirtualPages:!0,basePath:"",excludedRoutes:[],clearIds:!1,clearHash:!1,clearQueryParams:!1,idsRegExp:/^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/},this.developerMode=!1,this.ga={},this.appInsights={},this.gtm={},this.gst={}},l=new e.InjectionToken("ANGULARTICS2"),p=function(){function t(){}return t.prototype.trackLocation=function(t){return new a.BehaviorSubject({url:"/"})},t.prototype.prepareExternalUrl=function(t){return t},t}(),g=function(){function t(t,e){var r=this;this.tracker=t,this.pageTrack=new a.ReplaySubject(10),this.eventTrack=new a.ReplaySubject(10),this.exceptionTrack=new a.ReplaySubject(10),this.setAlias=new a.ReplaySubject(10),this.setUsername=new a.ReplaySubject(10),this.setUserProperties=new a.ReplaySubject(10),this.setUserPropertiesOnce=new a.ReplaySubject(10),this.setSuperProperties=new a.ReplaySubject(10),this.setSuperPropertiesOnce=new a.ReplaySubject(10),this.userTimings=new a.ReplaySubject(10);var n=new c;this.settings=s({},n,e.settings),this.settings.pageTracking=s({},n.pageTracking,e.settings.pageTracking),this.tracker.trackLocation(this.settings).subscribe(function(t){return r.trackUrlChange(t.url)})}return t.prototype.filterDeveloperMode=function(){var r=this;return n.filter(function(t,e){return!r.settings.developerMode})},t.prototype.trackUrlChange=function(t){if(this.settings.pageTracking.autoTrackVirtualPages&&!this.matchesExcludedRoute(t)){var e=this.clearUrl(t),r=void 0;r=this.settings.pageTracking.basePath.length?this.settings.pageTracking.basePath+e:this.tracker.prepareExternalUrl(e),this.pageTrack.next({path:r})}},t.prototype.matchesExcludedRoute=function(t){try{for(var e=function r(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}(this.settings.pageTracking.excludedRoutes),n=e.next();!n.done;n=e.next()){var a=n.value;if(a instanceof RegExp&&a.test(t)||-1!==t.indexOf(a))return!0}}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=e["return"])&&s.call(e)}finally{if(i)throw i.error}}return!1;var i,s},t.prototype.clearUrl=function(t){var e=this;return this.settings.pageTracking.clearIds||this.settings.pageTracking.clearQueryParams||this.settings.pageTracking.clearHash?t.split("/").map(function(t){return e.settings.pageTracking.clearQueryParams?t.split("?")[0]:t}).map(function(t){return e.settings.pageTracking.clearHash?t.split("#")[0]:t}).filter(function(t){return!e.settings.pageTracking.clearIds||!t.match(e.settings.pageTracking.idsRegExp)}).join("/"):t},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:p},{type:undefined,decorators:[{type:e.Inject,args:[l]}]}]},t}(),f=function(){function t(t,e){this.router=t,this.location=e}return t.prototype.trackLocation=function(t){return this.router.events.pipe(n.filter(function(t){return t instanceof i.NavigationEnd}),n.filter(function(){return!t.developerMode}),n.map(function(t){return{url:t.urlAfterRedirects}}),n.delay(0))},t.prototype.prepareExternalUrl=function(t){return this.location.prepareExternalUrl(t)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:i.Router},{type:r.Location}]},t}(),h=function(){function t(t,e,r){this.elRef=t,this.angulartics2=e,this.renderer=r,this.angularticsProperties={}}return t.prototype.ngAfterContentInit=function(){var e=this;this.renderer.listen(this.elRef.nativeElement,this.angulartics2On||"click",function(t){return e.eventTrack(t)})},t.prototype.eventTrack=function(t){var e=this.angularticsAction,r=s({},this.angularticsProperties,{eventType:t.type});this.angularticsCategory&&(r.category=this.angularticsCategory),this.angularticsLabel&&(r.label=this.angularticsLabel),this.angularticsValue&&(r.value=this.angularticsValue),this.angulartics2.eventTrack.next({action:e,properties:r})},t.decorators=[{type:e.Injectable},{type:e.Directive,args:[{selector:"[angulartics2On]"}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:g},{type:e.Renderer2}]},t.propDecorators={angulartics2On:[{type:e.Input,args:["angulartics2On"]}],angularticsAction:[{type:e.Input}],angularticsCategory:[{type:e.Input}],angularticsLabel:[{type:e.Input}],angularticsValue:[{type:e.Input}],angularticsProperties:[{type:e.Input}]},t}(),y=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[h],exports:[h]}]}],t}(),d=function(){function n(){}return n.forRoot=function(t,e){return void 0===e&&(e={}),{ngModule:n,providers:function r(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}([{provide:l,useValue:{providers:t,settings:e}},g,{provide:p,useClass:f}],t)}},n.decorators=[{type:e.NgModule,args:[{imports:[y],exports:[h]}]}],n}();t.Angulartics2=g,t.Angulartics2Module=d,t.ANGULARTICS2_TOKEN=l,t.Angulartics2On=h,t.Angulartics2OnModule=y,t.RouterlessTracking=p,t.AngularRouterTracking=f,t.DefaultConfig=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angulartics2.umd.min.js.map